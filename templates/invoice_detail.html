{% extends 'base.html' %}
{% block active %}active{% endblock %}
{% block content %}



<h2>Sales Invoices</h2>
<br>
<div class="row">                  
    <div class="col-lg-12">
       <div class="card   rounded">
          <div class="card-body">
             <div class="row">
                <div class="col-sm-12"> 
                       
                    <div class="row">
                        <!-- Left Column -->
                        <div class="col-md-6"> 
                            <h4 class="mb-2">Invoice Details - Bill No: {{ invoice.bill_no }}</h4>
                            <h6>Billing Type: {{ invoice.billing_type }}</h6>
                        </div>
                    
                        <!-- Right Column -->
                        <div class="col-md-6 text-md-end"> 
                            {% if invoice.customer %}                              
                                <h5 class="mb-3">Customer: {{ invoice.customer.name|default:"-" }}</h5>
                            {% else %}
                                <h5 class="mb-3">Supplier: {{ invoice.supplier.name|default:"-" }}</h5>
                            {% endif %}

                            <h6>Created At: {{ invoice.invoice_date|date:"Y-m-d H:i" }}</h6>
                        </div>
                    </div>
                    
                </div>
             </div>
      
             <div class="row">
                <div class="col-sm-12 mt-4">
                   <div class="table-responsive-lg">
                 <!-- Table Structure -->
<table class="table">
    <thead>

        <br>
        <tr>
            <th class="text-center">Item Name</th>
            <th class="text-center">Quantity</th>
            <th class="text-center">Unit</th>
            <th class="text-center">Price</th>
            <th class="text-center">Tax Amount</th>
            <th class="text-center">Total</th>
        </tr>
    </thead>
    <tbody id="invoice-body">
        {% for item in items %}
        <tr>
            <td class="text-center">{{ item.item_name }}</td>
            <td class="text-center">{{ item.qty }}</td>
            <td class="text-center">{{ item.unit }}</td>
            <td class="text-center">{{ item.price }}</td>
            <td class="text-center">{{ item.tax_amount }}</td>

            <td class="text-center total-amount">{{ item.total_amount }}</td>
        </tr>
        {% endfor %}
        <tr>
            <td class="text-center"></td>
            <td class="text-center"></td>
            <td class="text-center"></td>
            <td class="text-center">
                <h6 class="mb-0"><b>Total (Without Tax)</b></h6>
            </td>
            <td class="text-center">₹ {{ total_without_tax|floatformat:2 }}</td>
        </tr>
        <tr>
            <td class="text-center"></td>
            <td class="text-center"></td>
            <td class="text-center"></td>
            <td class="text-center">
                <h6 class="mb-0"><b>Total Tax</b></h6>
            </td>
            <td class="text-center">₹ {{ total_tax|floatformat:2 }}</td>
        </tr>
        <tr>
            <td class="text-center"></td>
            <td class="text-center"></td>
            <td class="text-center"></td>
            <td class="text-center">
                <h6 class="mb-0"><b>Grand Total</b></h6>
            </td>
            <td class="text-center">₹ {{ grand_total|floatformat:2 }}</td>
        </tr>
        
    </tbody>
</table>

<!-- JavaScript for Calculating Total -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    let totalSum = 0;
    let totalAmountCells = document.querySelectorAll(".total-amount");

    totalAmountCells.forEach(cell => {
        totalSum += parseFloat(cell.innerText) || 0;
    });

    document.getElementById("total-sum").innerText = "₹" + totalSum.toFixed(2);
});
</script>

                   </div>
                </div>                              
             </div>
             <div class="row">
                <div class="col-sm-12">
                  
                   <div class="d-flex justify-content-center mt-4">
                      <button type="button" class="btn btn-primary">Print</button>
                   </div>
                </div>
             </div>
          </div>
       </div>
    </div>                                    
 </div>







{% endblock %}